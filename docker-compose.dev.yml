version: '3.8'

services:
  logging-server:
    image: rejavarti/logging-server:latest
    container_name: rejavarti-logging-server
    environment:
      - AUTH_USERNAME=admin
      - AUTH_PASSWORD=testAdmin123!
      - JWT_SECRET=dev-secret-change-me
      - NODE_ENV=development
    ports:
      - "10180:3000"
      - "8081:8081"
      - "8082:8082"
      - "5044:5044"
      - "9880:9880"
      - "601:601"
      - "514:514/udp"
      - "12201:12201/udp"
      - "12202:12202"
    volumes:
      # Mount only specific directories for live code updates
      - ./routes:/app/routes
      - ./public:/app/public
      - ./views:/app/views
      - ./utils:/app/utils
      - ./configs:/app/configs
      # Persist data
      - ./data:/app/data
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:3000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
